# Decomposition code for phasemapping
The decomposition notebook uses an iterative scheme to use Non-negative matrix factorization (NMF) to decompose a 4D SPED dataset into a series of factors with corresponding loadings. The factors can be considered a certain contribution to the electron diffraction pattern signals present in the dataset, while the loadings are weights determining how the different factors should be mixed at each scan pixel. Hence, the loadings can be used as a phase map after sufficient thresholding. 

The notebook first runs a singular value decomposition (SVD) to analyze how many significant components there are in the dataset, and then it runs NMF with a given set of components to create loadings and factors (where the user must determine the number of components based on the output from the SVD and from trial-and-error). Next, the user must manually determine which phase each factor corresponds to, and how to best threshold their loadings. This process is then repeated again if not all the phases are identified, where the pixels that have already been identified are excluded (masked) from the dataset.
